{% load static i18n %}

<link rel="stylesheet" href="{% static 'plugins/inventory-in-out/inventree_inventoryinout/inout.css' %}">

<div class="page">
  <div class="topbar">
    Inventree - Inventory Ein/Aus
  </div>

  <div class="container">
    <div class="card">
      <div class="card-header">
        <h1 class="card-title">{% trans "Inventar In / Out" %}</h1>
      </div>

      <div class="card-body">
        <!-- Scan-Zeile -->
        <div>
          <label for="scan-input" class="io-label label">{% trans "IPN scannen / eingeben" %}</label>
          <div class="io-input-row">
            <input id="scan-input" class="io-input form-control" type="text" autocomplete="off" placeholder="{% trans 'IPN / Barcode' %}">
            <button id="scan-btn" type="button" class="io-btn io-btn-primary btn btn-primary">+ {% trans "Hinzufügen" %}</button>
          </div>
          <p class="io-hint" style="font-size:0.9em; color:#555;">
            {% trans "Tipp:" %} <kbd style="background:#000; color:#fff; padding:2px 6px; border-radius:4px;">Enter</kbd> {% trans "im Scan-Feld fügt ebenfalls hinzu." %}
          </p>
        </div>

        <!-- Notiz -->
        <div class="grid-1">
          <div>
            <div class="io-label label">{% trans "Buchungstext" %}</div>
            <input id="booking-notes" class="io-input form-control" required placeholder="{% trans 'z.B. Wareneingang 123' %}">
          </div>
        </div>

        <!-- Tabelle -->
        <div class="table-wrap">
          <table id="io-table" class="table table-striped io-table">
            <thead>
              <tr>
                <th>{% trans "IPN" %}</th>
                <th>{% trans "Produkt" %}</th>
                <th>{% trans "Lagerpfad" %}</th>
                <th class="right text-right">{% trans "Bestand" %}</th>
                <th class="qty right text-right">{% trans "Einbuchen" %}</th>
                <th class="qty right text-right">{% trans "Ausbuchen" %}</th>
                <th class="text-right">{% trans "Aktion" %}</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- Aktionen -->
        <div class="toolbar">
          <button id="book-btn" class="btn btn-success io-btn io-btn-success" data-role="book">{% trans "Buchen" %}</button>
          <button id="clear-btn" class="btn btn-ghost io-btn io-btn-ghost">{% trans "Zurücksetzen" %}</button>
        </div>

        <!-- Optional: Platz für Klartext-Protokoll -->
        <div id="plain-log" class="muted" style="margin-top:10px; white-space:pre-wrap;" aria-live="polite"></div>
      </div>
    </div>
  </div>
  <footer class="io-footer" style="margin-top:20px; text-align:center; font-size:0.85em; color:#666;">
    &copy; 2025 GrischaMedia – <a href="https://github.com/GrischaMedia/ch.grischamedia.inventree.inventoryinout" target="_blank">GitHub Repository</a>
  </footer>
</div>

<script>
  window.INOUT = {
    csrf: '{{ csrf_token }}',
    endpoints: {
      lookup: '{% url "plugin:inventory-in-out:index" %}',
      add:    '{% url "api-stock-add" %}',
      remove: '{% url "api-stock-remove" %}',
      list:   '{% url "api-stock-list" %}',
    },
    adds: [],
    removes: []
  };
</script>

<!-- Deine bestehende JS-Datei muss so eingebunden bleiben (Pfad wie bei dir funktionierend): -->
<script src="{% static 'plugins/inventory-in-out/inventree_inventoryinout/inout.js' %}"></script>